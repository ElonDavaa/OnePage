<div class="ep-layout">
  <div class="ep-container">
    <app-header></app-header>
    <div class="ep-body">
      <div class="ep-card admin">
        <div class="caption">
          <h3>Мэдээний жагсаалт</h3>
          <button pButton pRipple label="Мэдээ нэмэх" icon="pi pi-plus" (click)="onNew()"></button>
        </div>
        <p-table [value]="list" [sortField]="sortField" [sortOrder]="sortOrder" (sortFunction)="onSort($event)"
          [customSort]="true" [resizableColumns]="true" [scrollable]="true" dataKey="id">
          <ng-template pTemplate="header">
            <tr>
              <th rowspan="2" class="text-center">№</th>
              <th>Зураг</th>
              <th pSortableColumn="title">Мэдээний гарчиг <p-sortIcon field="title"></p-sortIcon></th>
              <th pSortableColumn="createdDate">Нийтэлсэн огноо <p-sortIcon field="createdDate"></p-sortIcon></th>
              <th pSortableColumn="createdBy">Нийтэлсэн хэрэглэгч <p-sortIcon field="createdBy"></p-sortIcon></th>
              <th>Үйлдэл</th>
            </tr>
            <tr>
              <th></th>
              <th>
                <input type="text" class="w-full" pInputText [(ngModel)]="search.title" (keyup.enter)="onSearch($event)"
                  (blur)="onSearch($event, 'title')">
              </th>
              <th>
                <p-calendar selectionMode="range" dateFormat="yy-mm-dd" [showIcon]="true" [showButtonBar]="true"
                  [readonlyInput]="true" [(ngModel)]="search.createdDate" (onClose)="onSearch($event)"
                  [appendTo]="calendar" styleClass="w-full"></p-calendar>
              </th>
              <th>
                <input type="text" class="w-full" pInputText [(ngModel)]="search.createdBy"
                  (keyup.enter)="onSearch($event)" (blur)="onSearch($event, 'createdBy')">
              </th>
              <th></th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-item let-index="rowIndex">

            <tr [pContextMenuRow]="item">
              <td>{{ first + index + 1 }}</td>
              <td>
                <img [src]="item.images ? item.images : 'assets/images/default.png'" height="36px" />
              </td>
              <td>{{item.title}}</td>
              <td>{{ item.createdDate | date: 'yyyy-MM-dd HH:mm' }}</td>
              <td>{{item.createdBy}}</td>
              <td class="flex gap-2 justify-content-center">
                <button pButton pRipple icon="pi pi-pencil" pTooltip="Засах" tooltipPosition="bottom"
                  class="p-button-text p-button-info" (click)="onEdit(item)"></button>
                <button pButton pRipple icon="pi pi-trash" pTooltip="Устгах" tooltipPosition="bottom"
                  class="p-button-text" (click)="onDelete(item)"></button>
              </td>
            </tr>
          </ng-template>
        </p-table>
        <p-paginator [showCurrentPageReport]=true
          currentPageReportTemplate="{{'common.pageReportTemplate' | translate}}" [totalRecords]="total" [first]="first"
          [rows]="pageable.size" (onPageChange)="paginateWithFilter($event)"
          [rowsPerPageOptions]="[10, 20, 50]"></p-paginator>
        <div #calendar></div>
      </div>
    </div>
  </div>
</div>